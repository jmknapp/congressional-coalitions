#!/usr/bin/env python3
"""
Auto-generated script to fix caucus membership inconsistencies.
Review this script before running it.
"""

import os
import sys
from datetime import datetime
sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from src.utils.database import get_db_session
from scripts.setup_caucus_tables import Caucus, CaucusMembership

def fix_inconsistencies():
    """Fix caucus membership inconsistencies."""
    print("🔧 Fixing caucus membership inconsistencies...")
    
    with get_db_session() as session:

        # Remove inconsistent members
        removals = [{'member_id': 'R000614', 'member_name': 'Chip Roy', 'caucus_name': 'Freedom Caucus', 'issue': 'Partyliner score too low: 0.858 (expected ≥0.9)', 'partyliner_score': 0.858, 'expected_behavior': 'Should have ≥0.9 partyliner score'}, {'member_id': 'B001302', 'member_name': 'Andy Biggs', 'caucus_name': 'Freedom Caucus', 'issue': 'Partyliner score too low: 0.879 (expected ≥0.9)', 'partyliner_score': 0.879, 'expected_behavior': 'Should have ≥0.9 partyliner score'}, {'member_id': 'B001316', 'member_name': 'Eric Burlison', 'caucus_name': 'Freedom Caucus', 'issue': 'Partyliner score too low: 0.889 (expected ≥0.9)', 'partyliner_score': 0.889, 'expected_behavior': 'Should have ≥0.9 partyliner score'}, {'member_id': 'C001132', 'member_name': 'Elijah Crane', 'caucus_name': 'Freedom Caucus', 'issue': 'Partyliner score too low: 0.888 (expected ≥0.9)', 'partyliner_score': 0.888, 'expected_behavior': 'Should have ≥0.9 partyliner score'}, {'member_id': 'P000605', 'member_name': 'Scott Perry', 'caucus_name': 'Freedom Caucus', 'issue': 'Partyliner score too low: 0.886 (expected ≥0.9)', 'partyliner_score': 0.886, 'expected_behavior': 'Should have ≥0.9 partyliner score'}, {'member_id': 'B000490', 'member_name': 'Sanford Bishop', 'caucus_name': 'Blue Dog', 'issue': 'Partyliner score too high: 0.959 (expected ≤0.85)', 'partyliner_score': 0.959, 'expected_behavior': 'Should have ≤0.85 partyliner score'}, {'member_id': 'C001110', 'member_name': 'J. Correa', 'caucus_name': 'Blue Dog', 'issue': 'Partyliner score too high: 0.987 (expected ≤0.85)', 'partyliner_score': 0.987, 'expected_behavior': 'Should have ≤0.85 partyliner score'}, {'member_id': 'C001059', 'member_name': 'Jim Costa', 'caucus_name': 'Blue Dog', 'issue': 'Partyliner score too high: 0.941 (expected ≤0.85)', 'partyliner_score': 0.941, 'expected_behavior': 'Should have ≤0.85 partyliner score'}, {'member_id': 'C001063', 'member_name': 'Henry Cuellar', 'caucus_name': 'Blue Dog', 'issue': 'Party line voting too high: 81.4% (expected ≤80.0%)', 'partyliner_score': 0.843, 'expected_behavior': 'Should have ≤80.0% party line voting'}, {'member_id': 'G000592', 'member_name': 'Jared Golden', 'caucus_name': 'Blue Dog', 'issue': 'Party line voting too high: 82.3% (expected ≤80.0%)', 'partyliner_score': 0.841, 'expected_behavior': 'Should have ≤80.0% party line voting'}, {'member_id': 'G000581', 'member_name': 'Vicente Gonzalez', 'caucus_name': 'Blue Dog', 'issue': 'Partyliner score too high: 0.877 (expected ≤0.85)', 'partyliner_score': 0.877, 'expected_behavior': 'Should have ≤0.85 partyliner score'}, {'member_id': 'G000583', 'member_name': 'Josh Gottheimer', 'caucus_name': 'Blue Dog', 'issue': 'Partyliner score too high: 0.965 (expected ≤0.85)', 'partyliner_score': 0.965, 'expected_behavior': 'Should have ≤0.85 partyliner score'}, {'member_id': 'G000605', 'member_name': 'Adam Gray', 'caucus_name': 'Blue Dog', 'issue': 'Partyliner score too high: 0.883 (expected ≤0.85)', 'partyliner_score': 0.883, 'expected_behavior': 'Should have ≤0.85 partyliner score'}, {'member_id': 'G000600', 'member_name': 'Marie Perez', 'caucus_name': 'Blue Dog', 'issue': 'Party line voting too high: 81.5% (expected ≤80.0%)', 'partyliner_score': 0.834, 'expected_behavior': 'Should have ≤80.0% party line voting'}, {'member_id': 'T000460', 'member_name': 'Mike Thompson', 'caucus_name': 'Blue Dog', 'issue': 'Partyliner score too high: 0.979 (expected ≤0.85)', 'partyliner_score': 0.979, 'expected_behavior': 'Should have ≤0.85 partyliner score'}, {'member_id': 'V000133', 'member_name': 'Jefferson Van Drew', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.963 (expected ≥0.995)', 'partyliner_score': 0.963, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S001176', 'member_name': 'Steve Scalise', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.993 (expected ≥0.995)', 'partyliner_score': 0.993, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001194', 'member_name': 'John Moolenaar', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.984 (expected ≥0.995)', 'partyliner_score': 0.984, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'N000026', 'member_name': 'Troy Nehls', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.980 (expected ≥0.995)', 'partyliner_score': 0.98, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'K000376', 'member_name': 'Mike Kelly', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.987 (expected ≥0.995)', 'partyliner_score': 0.987, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'J000289', 'member_name': 'Jim Jordan', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.983 (expected ≥0.995)', 'partyliner_score': 0.983, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'H001058', 'member_name': 'Bill Huizenga', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.983 (expected ≥0.995)', 'partyliner_score': 0.983, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'G000591', 'member_name': 'Michael Guest', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.980 (expected ≥0.995)', 'partyliner_score': 0.98, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'H001082', 'member_name': 'Kevin Hern', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.986 (expected ≥0.995)', 'partyliner_score': 0.986, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'F000450', 'member_name': 'Virginia Foxx', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.993 (expected ≥0.995)', 'partyliner_score': 0.993, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'I000056', 'member_name': 'Darrell Issa', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.980 (expected ≥0.995)', 'partyliner_score': 0.98, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'H001100', 'member_name': 'Jeff Hurd', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.985 (expected ≥0.995)', 'partyliner_score': 0.985, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M000317', 'member_name': 'Nicole Malliotakis', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.959 (expected ≥0.995)', 'partyliner_score': 0.959, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'B001306', 'member_name': 'Troy Balderson', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.988 (expected ≥0.995)', 'partyliner_score': 0.988, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'L000600', 'member_name': 'Nicholas Langworthy', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.985 (expected ≥0.995)', 'partyliner_score': 0.985, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'G000568', 'member_name': 'H. Griffith', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.978 (expected ≥0.995)', 'partyliner_score': 0.978, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'L000595', 'member_name': 'Julia Letlow', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.993 (expected ≥0.995)', 'partyliner_score': 0.993, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M000194', 'member_name': 'Nancy Mace', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.977 (expected ≥0.995)', 'partyliner_score': 0.977, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001236', 'member_name': 'Tim Moore', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.992 (expected ≥0.995)', 'partyliner_score': 0.992, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'D000600', 'member_name': 'Mario Diaz-Balart', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.978 (expected ≥0.995)', 'partyliner_score': 0.978, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'C000059', 'member_name': 'Ken Calvert', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.969 (expected ≥0.995)', 'partyliner_score': 0.969, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'L000491', 'member_name': 'Frank Lucas', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.980 (expected ≥0.995)', 'partyliner_score': 0.98, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001205', 'member_name': 'Carol Miller', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.993 (expected ≥0.995)', 'partyliner_score': 0.993, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'H001091', 'member_name': 'Ashley Hinson', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.987 (expected ≥0.995)', 'partyliner_score': 0.987, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'G000593', 'member_name': 'Carlos Gimenez', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.981 (expected ≥0.995)', 'partyliner_score': 0.981, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'B001323', 'member_name': 'Nicholas Begich', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.985 (expected ≥0.995)', 'partyliner_score': 0.985, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'T000467', 'member_name': 'Glenn Thompson', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.980 (expected ≥0.995)', 'partyliner_score': 0.98, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S000168', 'member_name': 'Maria Salazar', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'C001133', 'member_name': 'Juan Ciscomani', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.978 (expected ≥0.995)', 'partyliner_score': 0.978, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'B001301', 'member_name': 'Jack Bergman', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.987 (expected ≥0.995)', 'partyliner_score': 0.987, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'W000816', 'member_name': 'Roger Williams', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.988 (expected ≥0.995)', 'partyliner_score': 0.988, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'F000475', 'member_name': 'Brad Finstad', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.993 (expected ≥0.995)', 'partyliner_score': 0.993, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'B001298', 'member_name': 'Don Bacon', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.958 (expected ≥0.995)', 'partyliner_score': 0.958, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'L000597', 'member_name': 'Laurel Lee', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.987 (expected ≥0.995)', 'partyliner_score': 0.987, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'C001126', 'member_name': 'Mike Carey', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.980 (expected ≥0.995)', 'partyliner_score': 0.98, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S001148', 'member_name': 'Michael Simpson', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.968 (expected ≥0.995)', 'partyliner_score': 0.968, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'L000583', 'member_name': 'Barry Loudermilk', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.993 (expected ≥0.995)', 'partyliner_score': 0.993, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'B001322', 'member_name': 'Michael Baumgartner', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.993 (expected ≥0.995)', 'partyliner_score': 0.993, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001199', 'member_name': 'Brian Mast', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.985 (expected ≥0.995)', 'partyliner_score': 0.985, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S001189', 'member_name': 'Austin Scott', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.988 (expected ≥0.995)', 'partyliner_score': 0.988, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'B000740', 'member_name': 'Stephanie Bice', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.985 (expected ≥0.995)', 'partyliner_score': 0.985, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'E000235', 'member_name': 'Mike Ezell', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.969 (expected ≥0.995)', 'partyliner_score': 0.969, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'B001321', 'member_name': 'Tom Barrett', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.987 (expected ≥0.995)', 'partyliner_score': 0.987, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'B000668', 'member_name': 'Cliff Bentz', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.969 (expected ≥0.995)', 'partyliner_score': 0.969, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'W000821', 'member_name': 'Bruce Westerman', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.984 (expected ≥0.995)', 'partyliner_score': 0.984, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S001188', 'member_name': 'Marlin Stutzman', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.986 (expected ≥0.995)', 'partyliner_score': 0.986, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001215', 'member_name': 'Mariannette Miller-Meeks', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.966 (expected ≥0.995)', 'partyliner_score': 0.966, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'G000558', 'member_name': 'Brett Guthrie', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.980 (expected ≥0.995)', 'partyliner_score': 0.98, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'F000246', 'member_name': 'Pat Fallon', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.984 (expected ≥0.995)', 'partyliner_score': 0.984, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'A000055', 'member_name': 'Robert Aderholt', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.979 (expected ≥0.995)', 'partyliner_score': 0.979, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'A000379', 'member_name': 'Mark Alford', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.979 (expected ≥0.995)', 'partyliner_score': 0.979, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'B001257', 'member_name': 'Gus Bilirakis', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'F000482', 'member_name': 'Julie Fedorchak', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'H001093', 'member_name': 'Erin Houchin', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.989 (expected ≥0.995)', 'partyliner_score': 0.989, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'K000398', 'member_name': 'Thomas Kean', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.969 (expected ≥0.995)', 'partyliner_score': 0.969, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'W000812', 'member_name': 'Ann Wagner', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.979 (expected ≥0.995)', 'partyliner_score': 0.979, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S000250', 'member_name': 'Pete Sessions', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.982 (expected ≥0.995)', 'partyliner_score': 0.982, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'K000404', 'member_name': 'Kimberlyn King-Hinds', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.640 (expected ≥0.995)', 'partyliner_score': 0.64, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'L000598', 'member_name': 'Nick LaLota', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.956 (expected ≥0.995)', 'partyliner_score': 0.956, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'C001108', 'member_name': 'James Comer', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.983 (expected ≥0.995)', 'partyliner_score': 0.983, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'G000597', 'member_name': 'Andrew Garbarino', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.979 (expected ≥0.995)', 'partyliner_score': 0.979, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S001196', 'member_name': 'Elise Stefanik', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.987 (expected ≥0.995)', 'partyliner_score': 0.987, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'K000397', 'member_name': 'Young Kim', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.969 (expected ≥0.995)', 'partyliner_score': 0.969, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'D000594', 'member_name': 'Monica De La Cruz', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.990 (expected ≥0.995)', 'partyliner_score': 0.99, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'K000399', 'member_name': 'Jennifer Kiggans', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.968 (expected ≥0.995)', 'partyliner_score': 0.968, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'W000804', 'member_name': 'Robert Wittman', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'V000129', 'member_name': 'David Valadao', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.951 (expected ≥0.995)', 'partyliner_score': 0.951, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'H001072', 'member_name': 'J. Hill', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.980 (expected ≥0.995)', 'partyliner_score': 0.98, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S001213', 'member_name': 'Bryan Steil', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.989 (expected ≥0.995)', 'partyliner_score': 0.989, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'C001053', 'member_name': 'Tom Cole', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.980 (expected ≥0.995)', 'partyliner_score': 0.98, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'F000459', 'member_name': 'Charles Fleischmann', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.980 (expected ≥0.995)', 'partyliner_score': 0.98, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'F000472', 'member_name': 'Scott Franklin', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.992 (expected ≥0.995)', 'partyliner_score': 0.992, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'T000490', 'member_name': 'David Taylor', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.987 (expected ≥0.995)', 'partyliner_score': 0.987, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'E000300', 'member_name': 'Gabe Evans', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.988 (expected ≥0.995)', 'partyliner_score': 0.988, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'V000134', 'member_name': 'Beth Van Duyne', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.986 (expected ≥0.995)', 'partyliner_score': 0.986, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'B001307', 'member_name': 'James Baird', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.981 (expected ≥0.995)', 'partyliner_score': 0.981, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'N000193', 'member_name': 'Zachary Nunn', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.977 (expected ≥0.995)', 'partyliner_score': 0.977, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'O000019', 'member_name': 'Jay Obernolte', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.975 (expected ≥0.995)', 'partyliner_score': 0.975, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'P000048', 'member_name': 'August Pfluger', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'R000612', 'member_name': 'John Rose', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.990 (expected ≥0.995)', 'partyliner_score': 0.99, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'W000809', 'member_name': 'Steve Womack', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.980 (expected ≥0.995)', 'partyliner_score': 0.98, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001219', 'member_name': 'James Moylan', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.459 (expected ≥0.995)', 'partyliner_score': 0.459, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'G000601', 'member_name': 'Craig Goldman', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.981 (expected ≥0.995)', 'partyliner_score': 0.981, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'R000395', 'member_name': 'Harold Rogers', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.980 (expected ≥0.995)', 'partyliner_score': 0.98, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'D000634', 'member_name': 'Troy Downing', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.979 (expected ≥0.995)', 'partyliner_score': 0.979, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'F000474', 'member_name': 'Mike Flood', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.975 (expected ≥0.995)', 'partyliner_score': 0.975, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001204', 'member_name': 'Daniel Meuser', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.986 (expected ≥0.995)', 'partyliner_score': 0.986, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'F000471', 'member_name': 'Scott Fitzgerald', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.993 (expected ≥0.995)', 'partyliner_score': 0.993, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'E000246', 'member_name': 'Chuck Edwards', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.967 (expected ≥0.995)', 'partyliner_score': 0.967, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001230', 'member_name': 'Ryan Mackenzie', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.962 (expected ≥0.995)', 'partyliner_score': 0.962, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'F000480', 'member_name': 'Vince Fong', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.973 (expected ≥0.995)', 'partyliner_score': 0.973, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'F000446', 'member_name': 'Randy Feenstra', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.978 (expected ≥0.995)', 'partyliner_score': 0.978, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'Y000067', 'member_name': 'Rudy Yakym', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'R000603', 'member_name': 'David Rouzer', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.992 (expected ≥0.995)', 'partyliner_score': 0.992, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'N000189', 'member_name': 'Dan Newhouse', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.968 (expected ≥0.995)', 'partyliner_score': 0.968, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'P000609', 'member_name': 'Gary Palmer', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.981 (expected ≥0.995)', 'partyliner_score': 0.981, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S001220', 'member_name': 'Dale Strong', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.979 (expected ≥0.995)', 'partyliner_score': 0.979, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'V000135', 'member_name': 'Derrick Van Orden', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.990 (expected ≥0.995)', 'partyliner_score': 0.99, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'L000566', 'member_name': 'Robert Latta', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.991 (expected ≥0.995)', 'partyliner_score': 0.991, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'W000806', 'member_name': 'Daniel Webster', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.991 (expected ≥0.995)', 'partyliner_score': 0.991, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S001195', 'member_name': 'Jason Smith', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.988 (expected ≥0.995)', 'partyliner_score': 0.988, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'J000295', 'member_name': 'David Joyce', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.966 (expected ≥0.995)', 'partyliner_score': 0.966, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001213', 'member_name': 'Blake Moore', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.991 (expected ≥0.995)', 'partyliner_score': 0.991, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001240', 'member_name': 'Addison McDowell', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.979 (expected ≥0.995)', 'partyliner_score': 0.979, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001157', 'member_name': 'Michael McCaul', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.965 (expected ≥0.995)', 'partyliner_score': 0.965, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'T000480', 'member_name': 'William Timmons', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.989 (expected ≥0.995)', 'partyliner_score': 0.989, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'B001291', 'member_name': 'Brian Babin', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.993 (expected ≥0.995)', 'partyliner_score': 0.993, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'W000829', 'member_name': 'Tony Wied', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.981 (expected ≥0.995)', 'partyliner_score': 0.981, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'H001099', 'member_name': 'Mike Haridopolos', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.965 (expected ≥0.995)', 'partyliner_score': 0.965, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'H001095', 'member_name': 'Wesley Hunt', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.985 (expected ≥0.995)', 'partyliner_score': 0.985, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'H001067', 'member_name': 'Richard Hudson', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.988 (expected ≥0.995)', 'partyliner_score': 0.988, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'R000619', 'member_name': 'Michael Rulli', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.974 (expected ≥0.995)', 'partyliner_score': 0.974, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'A000375', 'member_name': 'Jodey Arrington', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.991 (expected ≥0.995)', 'partyliner_score': 0.991, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001233', 'member_name': 'Mark Messmer', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.991 (expected ≥0.995)', 'partyliner_score': 0.991, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'G000589', 'member_name': 'Lance Gooden', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.984 (expected ≥0.995)', 'partyliner_score': 0.984, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'J000307', 'member_name': 'John James', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.978 (expected ≥0.995)', 'partyliner_score': 0.978, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'L000599', 'member_name': 'Michael Lawler', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.956 (expected ≥0.995)', 'partyliner_score': 0.956, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'L000603', 'member_name': 'Morgan Luttrell', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.978 (expected ≥0.995)', 'partyliner_score': 0.978, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S001172', 'member_name': 'Adrian Smith', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.984 (expected ≥0.995)', 'partyliner_score': 0.984, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'Z000018', 'member_name': 'Ryan Zinke', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.985 (expected ≥0.995)', 'partyliner_score': 0.985, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'A000369', 'member_name': 'Mark Amodei', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.974 (expected ≥0.995)', 'partyliner_score': 0.974, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'G000576', 'member_name': 'Glenn Grothman', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.977 (expected ≥0.995)', 'partyliner_score': 0.977, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'G000594', 'member_name': 'Tony Gonzales', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.993 (expected ≥0.995)', 'partyliner_score': 0.993, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001222', 'member_name': 'Max Miller', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.982 (expected ≥0.995)', 'partyliner_score': 0.982, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'O000086', 'member_name': 'Burgess Owens', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.980 (expected ≥0.995)', 'partyliner_score': 0.98, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'B001260', 'member_name': 'Vern Buchanan', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.984 (expected ≥0.995)', 'partyliner_score': 0.984, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S001199', 'member_name': 'Lloyd Smucker', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'W000814', 'member_name': 'Randy Weber', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'J000311', 'member_name': 'Brian Jack', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.984 (expected ≥0.995)', 'partyliner_score': 0.984, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'R000575', 'member_name': 'Mike Rogers', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.979 (expected ≥0.995)', 'partyliner_score': 0.979, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'B001327', 'member_name': 'Robert Bresnahan', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.984 (expected ≥0.995)', 'partyliner_score': 0.984, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'W000798', 'member_name': 'Tim Walberg', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.986 (expected ≥0.995)', 'partyliner_score': 0.986, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001228', 'member_name': 'Celeste Maloy', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.966 (expected ≥0.995)', 'partyliner_score': 0.966, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S001212', 'member_name': 'Pete Stauber', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.981 (expected ≥0.995)', 'partyliner_score': 0.981, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'D000616', 'member_name': 'Scott DesJarlais', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.988 (expected ≥0.995)', 'partyliner_score': 0.988, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'C001120', 'member_name': 'Dan Crenshaw', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'F000470', 'member_name': 'Michelle Fischbach', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.992 (expected ≥0.995)', 'partyliner_score': 0.992, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S000522', 'member_name': 'Christopher Smith', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.978 (expected ≥0.995)', 'partyliner_score': 0.978, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'E000298', 'member_name': 'Ron Estes', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.973 (expected ≥0.995)', 'partyliner_score': 0.973, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'K000392', 'member_name': 'David Kustoff', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.990 (expected ≥0.995)', 'partyliner_score': 0.99, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'K000401', 'member_name': 'Kevin Kiley', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.963 (expected ≥0.995)', 'partyliner_score': 0.963, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M000871', 'member_name': 'Tracey Mann', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.990 (expected ≥0.995)', 'partyliner_score': 0.99, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001136', 'member_name': 'Lisa McClain', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.981 (expected ≥0.995)', 'partyliner_score': 0.981, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'E000071', 'member_name': 'Jake Ellzey', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.980 (expected ≥0.995)', 'partyliner_score': 0.98, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'T000463', 'member_name': 'Michael Turner', 'caucus_name': 'MAGA', 'issue': 'Partyliner score too low: 0.948 (expected ≥0.995)', 'partyliner_score': 0.948, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001225', 'member_name': 'Kevin Mullin', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.990 (expected ≥0.995)', 'partyliner_score': 0.99, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'G000587', 'member_name': 'Sylvia Garcia', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.991 (expected ≥0.995)', 'partyliner_score': 0.991, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'C001136', 'member_name': 'Herbert Conaway', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.983 (expected ≥0.995)', 'partyliner_score': 0.983, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'R000599', 'member_name': 'Raul Ruiz', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.992 (expected ≥0.995)', 'partyliner_score': 0.992, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'T000193', 'member_name': 'Bennie Thompson', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.989 (expected ≥0.995)', 'partyliner_score': 0.989, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001163', 'member_name': 'Doris Matsui', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.993 (expected ≥0.995)', 'partyliner_score': 0.993, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'J000298', 'member_name': 'Pramila Jayapal', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.986 (expected ≥0.995)', 'partyliner_score': 0.986, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'H001085', 'member_name': 'Chrissy Houlahan', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.982 (expected ≥0.995)', 'partyliner_score': 0.982, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001238', 'member_name': 'Sarah McBride', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.991 (expected ≥0.995)', 'partyliner_score': 0.991, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'C001069', 'member_name': 'Joe Courtney', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.986 (expected ≥0.995)', 'partyliner_score': 0.986, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'H001068', 'member_name': 'Jared Huffman', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'C001091', 'member_name': 'Joaquin Castro', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'J000288', 'member_name': 'Henry Johnson', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.992 (expected ≥0.995)', 'partyliner_score': 0.992, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'P000608', 'member_name': 'Scott Peters', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.988 (expected ≥0.995)', 'partyliner_score': 0.988, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'B001287', 'member_name': 'Ami Bera', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.991 (expected ≥0.995)', 'partyliner_score': 0.991, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'T000460', 'member_name': 'Mike Thompson', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.979 (expected ≥0.995)', 'partyliner_score': 0.979, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'C001125', 'member_name': 'Troy Carter', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.991 (expected ≥0.995)', 'partyliner_score': 0.991, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'N000188', 'member_name': 'Donald Norcross', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.990 (expected ≥0.995)', 'partyliner_score': 0.99, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S001193', 'member_name': 'Eric Swalwell', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.990 (expected ≥0.995)', 'partyliner_score': 0.99, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001206', 'member_name': 'Joseph Morelle', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.982 (expected ≥0.995)', 'partyliner_score': 0.982, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'D000530', 'member_name': 'Christopher Deluzio', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.987 (expected ≥0.995)', 'partyliner_score': 0.987, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'E000301', 'member_name': 'Sarah Elfreth', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'K000389', 'member_name': 'Ro Khanna', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'C000537', 'member_name': 'James Clyburn', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.993 (expected ≥0.995)', 'partyliner_score': 0.993, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'N000002', 'member_name': 'Jerrold Nadler', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.991 (expected ≥0.995)', 'partyliner_score': 0.991, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'D000216', 'member_name': 'Rosa DeLauro', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.993 (expected ≥0.995)', 'partyliner_score': 0.993, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'C001055', 'member_name': 'Ed Case', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.974 (expected ≥0.995)', 'partyliner_score': 0.974, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'G000553', 'member_name': 'Al Green', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.986 (expected ≥0.995)', 'partyliner_score': 0.986, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'P000617', 'member_name': 'Ayanna Pressley', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.969 (expected ≥0.995)', 'partyliner_score': 0.969, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'H001047', 'member_name': 'James Himes', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.982 (expected ≥0.995)', 'partyliner_score': 0.982, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'L000560', 'member_name': 'Rick Larsen', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.993 (expected ≥0.995)', 'partyliner_score': 0.993, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'C001067', 'member_name': 'Yvette Clarke', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.988 (expected ≥0.995)', 'partyliner_score': 0.988, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'G000585', 'member_name': 'Jimmy Gomez', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S001231', 'member_name': 'Lateefah Simon', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.980 (expected ≥0.995)', 'partyliner_score': 0.98, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'B001296', 'member_name': 'Brendan Boyle', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.987 (expected ≥0.995)', 'partyliner_score': 0.987, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S001226', 'member_name': 'Andrea Salinas', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'F000110', 'member_name': 'Cleo Fields', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'L000602', 'member_name': 'Summer Lee', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.966 (expected ≥0.995)', 'partyliner_score': 0.966, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'P000197', 'member_name': 'Nancy Pelosi', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'B001324', 'member_name': 'Wesley Bell', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.989 (expected ≥0.995)', 'partyliner_score': 0.989, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'T000468', 'member_name': 'Dina Titus', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.986 (expected ≥0.995)', 'partyliner_score': 0.986, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'A000381', 'member_name': 'Yassamin Ansari', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'T000488', 'member_name': 'Shri Thanedar', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.984 (expected ≥0.995)', 'partyliner_score': 0.984, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'W000187', 'member_name': 'Maxine Waters', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.989 (expected ≥0.995)', 'partyliner_score': 0.989, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'K000375', 'member_name': 'William Keating', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.992 (expected ≥0.995)', 'partyliner_score': 0.992, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'P000621', 'member_name': 'Nellie Pou', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.992 (expected ≥0.995)', 'partyliner_score': 0.992, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'L000397', 'member_name': 'Zoe Lofgren', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.987 (expected ≥0.995)', 'partyliner_score': 0.987, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'C001123', 'member_name': 'Gilbert Cisneros', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.982 (expected ≥0.995)', 'partyliner_score': 0.982, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'H001081', 'member_name': 'Jahana Hayes', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.990 (expected ≥0.995)', 'partyliner_score': 0.99, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'L000606', 'member_name': 'George Latimer', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.990 (expected ≥0.995)', 'partyliner_score': 0.99, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'G000599', 'member_name': 'Daniel Goldman', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.987 (expected ≥0.995)', 'partyliner_score': 0.987, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001160', 'member_name': 'Gwen Moore', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'K000402', 'member_name': 'Timothy Kennedy', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.987 (expected ≥0.995)', 'partyliner_score': 0.987, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'W000797', 'member_name': 'Debbie Wasserman Schultz', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.993 (expected ≥0.995)', 'partyliner_score': 0.993, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'D000635', 'member_name': 'Maxine Dexter', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.987 (expected ≥0.995)', 'partyliner_score': 0.987, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'L000562', 'member_name': 'Stephen Lynch', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.982 (expected ≥0.995)', 'partyliner_score': 0.982, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'B001281', 'member_name': 'Joyce Beatty', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'C001110', 'member_name': 'J. Correa', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.987 (expected ≥0.995)', 'partyliner_score': 0.987, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'P000597', 'member_name': 'Chellie Pingree', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'R000617', 'member_name': 'Delia Ramirez', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.967 (expected ≥0.995)', 'partyliner_score': 0.967, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'O000173', 'member_name': 'Ilhan Omar', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.949 (expected ≥0.995)', 'partyliner_score': 0.949, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'V000081', 'member_name': 'Nydia Velázquez', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.988 (expected ≥0.995)', 'partyliner_score': 0.988, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'F000468', 'member_name': 'Lizzie Fletcher', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.993 (expected ≥0.995)', 'partyliner_score': 0.993, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001226', 'member_name': 'Robert Menendez', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.990 (expected ≥0.995)', 'partyliner_score': 0.99, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'J000309', 'member_name': 'Jonathan Jackson', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.988 (expected ≥0.995)', 'partyliner_score': 0.988, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'T000474', 'member_name': 'Norma Torres', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.993 (expected ≥0.995)', 'partyliner_score': 0.993, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'P000034', 'member_name': 'Frank Pallone', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.990 (expected ≥0.995)', 'partyliner_score': 0.99, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'F000476', 'member_name': 'Maxwell Frost', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.987 (expected ≥0.995)', 'partyliner_score': 0.987, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'H001094', 'member_name': 'Val Hoyle', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.981 (expected ≥0.995)', 'partyliner_score': 0.981, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'O000172', 'member_name': 'Alexandria Ocasio-Cortez', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.978 (expected ≥0.995)', 'partyliner_score': 0.978, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M001223', 'member_name': 'Seth Magaziner', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.989 (expected ≥0.995)', 'partyliner_score': 0.989, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'T000486', 'member_name': 'Ritchie Torres', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.983 (expected ≥0.995)', 'partyliner_score': 0.983, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'C001131', 'member_name': 'Greg Casar', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.978 (expected ≥0.995)', 'partyliner_score': 0.978, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'M000312', 'member_name': 'James McGovern', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.991 (expected ≥0.995)', 'partyliner_score': 0.991, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'A000148', 'member_name': 'Jake Auchincloss', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.986 (expected ≥0.995)', 'partyliner_score': 0.986, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S000344', 'member_name': 'Brad Sherman', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.987 (expected ≥0.995)', 'partyliner_score': 0.987, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'F000462', 'member_name': 'Lois Frankel', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.993 (expected ≥0.995)', 'partyliner_score': 0.993, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'S001215', 'member_name': 'Haley Stevens', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.990 (expected ≥0.995)', 'partyliner_score': 0.99, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'K000400', 'member_name': 'Sydney Kamlager-Dove', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.994 (expected ≥0.995)', 'partyliner_score': 0.994, 'expected_behavior': 'Should have ≥0.995 partyliner score'}, {'member_id': 'G000586', 'member_name': 'Jesús García', 'caucus_name': 'TB', 'issue': 'Partyliner score too low: 0.967 (expected ≥0.995)', 'partyliner_score': 0.967, 'expected_behavior': 'Should have ≥0.995 partyliner score'}]
        
        for removal in removals:
            member_id = removal['member_id']
            caucus_name = removal['caucus_name']
            
            # Get caucus
            caucus = session.query(Caucus).filter(Caucus.short_name == caucus_name).first()
            if not caucus:
                print(f"⚠️  Caucus {caucus_name} not found")
                continue
            
            # End the membership
            membership = session.query(CaucusMembership).filter(
                CaucusMembership.caucus_id == caucus.id,
                CaucusMembership.member_id_bioguide == member_id,
                CaucusMembership.end_date.is_(None)
            ).first()
            
            if membership:
                membership.end_date = datetime.now().date()
                membership.notes = f"Removed due to inconsistency: {removal['issue']}"
                print(f"✓ Removed {removal['member_name']} from {caucus_name}")
            else:
                print(f"⚠️  No active membership found for {removal['member_name']} in {caucus_name}")
        
        session.commit()
        print(f"✓ Fixed {len(removals)} inconsistencies")

if __name__ == '__main__':
    fix_inconsistencies()
